!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["@discord-bot-creator/bot"]=t():e["@discord-bot-creator/bot"]=t()}(global,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("chalk")},function(e,t,n){"use strict";
/*!
 * Copyright (c) Discord Bot Creator.
 *
 * This source code is licensed under the GPL-3.0.
 */Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),o=n(3),a=new o.default(JSON.parse(i.readFileSync("./storage.json","utf-8")));(process.mainModule.filename.endsWith("bot")||process.mainModule.filename.endsWith("bot.js")||process.mainModule.filename.endsWith("index.ts"))&&a.start(),t.default=o.default},function(module,exports,__webpack_require__){"use strict";(function(__dirname){Object.defineProperty(exports,"__esModule",{value:!0});const Discord=__webpack_require__(4),fs=__webpack_require__(0),chalk=__webpack_require__(1),path=__webpack_require__(5),node_fetch_1=__webpack_require__(6),actions_1=__webpack_require__(7),utils=__webpack_require__(13);class DBCBot{constructor(e){e.config.intents||(e.config.intents=[],e.config.intents.push("GUILDS"),e.config.intents.push("GUILD_MESSAGES"),fs.writeFileSync("./storage.json",JSON.stringify(e,null,2),"utf-8")),e.config.intents.includes("GUILDS")||(e.config.intents.push("GUILDS"),fs.writeFileSync("./storage.json",JSON.stringify(e,null,2),"utf-8")),e.config.intents.includes("GUILD_MESSAGES")||(e.config.intents.push("GUILD_MESSAGES"),fs.writeFileSync("./storage.json",JSON.stringify(e,null,2),"utf-8")),this.storage=e,this.client=new Discord.Client({ws:{intents:this.storage.config.intents}}),this.globalVariables=new Map}get actions(){return actions_1.default}get utils(){return utils}get version(){return JSON.parse(fs.readFileSync("./package.json","utf-8")).version}async checkForUpdates(){if(!fs.existsSync(path.join(__dirname,"index.ts"))){this.utils.log("info","Checking if your bot is up to date...");try{const e=await(await node_fetch_1.default("https://raw.githubusercontent.com/discord-bot-creator/bot/master/dist/package.json")).json();if(this.version!==e.version){this.utils.log("alert","Your bot is not up to date, updating...");try{const t=await(await node_fetch_1.default("https://raw.githubusercontent.com/discord-bot-creator/bot/master/dist/bot.js")).text();fs.writeFileSync("./package.json",JSON.stringify(e,null,2),"utf-8"),fs.writeFileSync("./bot.js",t,"utf-8"),this.utils.log("success","Bot updated! Start your bot again.",!0)}catch(e){switch(e.code){case"ENOTFOUND":this.utils.log("error","Not was possible install the update, check your internet connection!",!0);break;default:this.utils.log("error","Unknown error: "+e,!0)}}}this.utils.log("info","Your bot is up to date.")}catch(e){switch(e.code){case"ENOTFOUND":this.utils.log("error","Not was possible check if your bot is up to date, check your internet connection!",!0);break;default:this.utils.log("error","Unknown error: "+e,!0)}}}}async setupEvents(){this.client.on("ready",()=>this.utils.log("success","Bot started!")),this.client.on("message",message=>{if(message.content.startsWith(this.storage.config.prefix)||!message.author.bot){const commandArgs=message.content.slice(this.storage.config.prefix.length).split(/ +/),commandName=this.storage.config.caseSensitive?commandArgs.shift().toLowerCase():commandArgs.shift(),command=this.storage.commands.find(e=>e.name===commandName)||this.storage.commands.find(e=>e.aliases.includes(commandName));if(command){const actions=this.actions,action=actions.find(e=>e.name===command.actions[0].name),log=this.utils.log,variables=new Map,globalVariables=this.globalVariables;if(action.intents&&!this.storage.config.intents.includes(action.intents))return log("error","Your bot config does not have the following intents to use some actions: "+action.intents.join(", "));function getField(index,id){const field=command.actions[index].fields.find(e=>e.id===id);if(field){const result=eval(`\n              function variable(name) {\n                return variables.get(name) || \n                globalVariables.get(name);\n              }\n              const command = message;\n              ${"`"+field.value+"`"}\n            `);return result}}function throwActionError(e,t){log("error",`Ocurred on command ${commandName} on action ${e}: ${t}`,!0)}function goToAction(e){e.index++,command.actions[e.index]&&actions.find(t=>t.name===command.actions[e.index].name).run(e)}const cache={client:this.client,message:message,index:0,variables:variables,globalVariables:globalVariables,getField:getField,throwActionError:throwActionError,goToAction:goToAction};action.run(cache)}}});for(const event of this.storage.events)this.client.on(event.type,(output0,output1)=>{const variables=new Map,globalVariables=this.globalVariables;if(event.outputs){let e=0;for(const t of event.outputs)output1&&1===e?variables.set(t,output1):variables.set(t,output0),e++}const actions=this.actions,action=actions.find(e=>e.name===event.actions[0].name),log=this.utils.log;function getField(index,id){const field=event.actions[index].fields.find(e=>e.id===id);if(field){const result=eval(`\n              function variable(name) {\n                return variables.get(name) || \n                globalVariables.get(name);\n              }\n              const command = message;\n              ${"`"+field.value+"`"}\n            `);return result}}function throwActionError(e,t){log("error",`Ocurred on event ${event.name} on action ${e}: ${t}`,!0)}function goToAction(e){e.index++,event.actions[e.index]&&actions.find(t=>t.name===event.actions[e.index].name).run(e)}const cache={index:0,variables:variables,globalVariables:globalVariables,getField:getField,throwActionError:throwActionError,client:this.client,goToAction:goToAction};action.run(cache)})}async start(){console.log(`\n  ${chalk.magenta("Discord Bot Creator")} Bot ${chalk.gray("v"+this.version)}\n__________________________________\n`),await this.checkForUpdates(),await this.setupEvents(),this.utils.log("info","Starting bot..."),this.client.login(this.storage.config.token).catch(e=>{switch(e.code){case"TOKEN_INVALID":this.utils.log("error","You placed an invalid token in your bot config.",!0);break;default:this.utils.log("error","Unknown error: "+e,!0)}})}}exports.default=DBCBot}).call(this,"/")},function(e,t){e.exports=require("discord.js")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("node-fetch")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),o=n(9),a=n(10),s=n(11),r=n(12),l=[i.default,o.default,a.default,s.default,r.default];t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=new class{get name(){return"Send Message"}get description(){return"Send messages to channels, users and bot logs."}get category(){return"Client/Messages"}html(e){return`\n      <div>\n        <div>\n          <label id="send-to">Send to</label>\n          <select id="send-to" isDBCField>\n            ${e?'\n              <option value="command-channel">\n                Command Channel\n              </option>\n              <option value="command-author">\n                Command Author\n              </option>\n            ':""}\n            <option value="bot-logs">Bot Logs</option>\n            <option value="variable">\n              Channel/User Variable\n            </option>\n            <option value="global-variable">\n              Channel/User Global Variable\n            </option>\n          </select>\n        </div>\n        <div id="variable-name-container" style="display: none;">\n          <label id="variable-name">Variable Name</label>\n          <input id="variable-name" type="text" isDBCField>\n        </div>\n      </div>\n      <div>\n        <label id="message">Message</label>\n        <textarea id="message" isDBCField></textarea>\n      </div>\n      <script>\n        const messageSendTo = document.getElementById('message-send-to')\n        const variableNameContainer = document.getElementById('variable-name-container')\n            \n        messageSendTo.addEventListener('select', (e) => {\n          if (\n            e.target.value === 'channel-user-variable' ||\n            e.target.value === 'channel-user-global-variable'\n          ) {\n            variableNameContainer.style.display = ''\n          } else {\n            if (variableNameContainer.style.display !== 'none') {\n              variableNameContainer.style.display = 'none'\n            }\n          }\n        })\n      <\/script>\n    `}async run(e){const t=e.getField(e.index,"send-to"),n=e.getField(e.index,"variable-name"),i=e.getField(e.index,"message");try{switch(t){case"command-channel":await e.message.channel.send(i);break;case"command-author":await e.message.author.send(i);break;case"variable":await e.variables.get(n).send(i);break;case"global-variable":await e.globalVariables.get(n).send(i)}e.goToAction(e)}catch(t){e.throwActionError(e.index,t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=new class{get name(){return"Jump to Action"}get description(){return"Jump to any selected action number, if exists."}get category(){return"Actions"}html(){return'\n      <div>\n        <label id="action-to-jump">Action to Jump</label>\n        <input id="action-to-jump" type="number" isDBCField>\n      </div>\n    '}run(e){const t=Number(e.getField(e.index,"action-to-jump"));e.index=t,e.goToAction(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=new class{get name(){return"Skip Actions"}get description(){return"Skip a sequence of actions according with the amount."}get category(){return"Actions"}html(){return'\n      <div>\n        <label id="amount-to-skip">Amount to Skip</label>\n        <input id="amount-to-skip" type="number" isDBCField>\n      </div>\n    '}run(e){const t=Number(e.getField(e.index,"amount-to-skip"));e.index+=t,e.goToAction(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=new class{get name(){return"Stop Actions"}get description(){return"Stop the actions sequence."}get category(){return"Actions"}html(){}run(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=new class{get name(){return"Create Variable"}get description(){return"Create custom variables."}get category(){return"Variables"}html(){return'\n      <div>\n        <label id="variable-type">Variable Type</label>\n        <select id="variable-type" isDBCField>\n          <option value="text">Text</option>\n          <option value="number">Number</option>\n          <option value="object">Object</option>\n          <option value="list">List</option>\n          <option value="true-false">True/false</option>\n        </select>\n      </div>\n      <br>\n      <div>\n        <label id="variable-value">Variable Value</label>\n        <textarea id="variable-value" isDBCField></textarea>\n      </div>\n      <br>\n      <div>\n        <div>\n          <label id="variable-storage">Store in</label>\n          <select id="variable-storage" isDBCField>\n            <option value="temp">Variable</option>\n            <option value="global">Global Variable</option>\n          </select>\n        </div>\n        <div>\n          <label id="variable-name">Variable Name</label>\n          <input id="variable-name" type="text" isDBCField>\n        </div>\n      </div>\n    '}run(e){const t=e.getField(e.index,"variable-type");let n=e.getField(e.index,"variable-value");const i=e.getField(e.index,"variable-storage"),o=e.getField(e.index,"variable-name");switch(t){case"text":n=String(n);break;case"number":n=Number(n);break;case"object":n=Object(n);break;case"list":n=Array(n);break;case"true-false":n=Boolean(n)}"temp"===i?e.variables.set(o,n):e.globalVariables.set(o,n),e.goToAction(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=void 0;const i=n(14);t.log=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=function(e,t,n){const o=new Date,a=`${o.getMonth()}/${o.getDate()}/${o.getFullYear()} - ${o.getHours()}:${o.getMinutes()}:${o.getSeconds()}`;switch(e){case"info":console.log(`${i.gray("["+a+"]")} ${i.blue("info")} ${t}`);break;case"success":console.log(`${i.gray("["+a+"]")} ${i.green("success")} ${t}`);break;case"error":console.error(`${i.gray("["+a+"]")} ${i.red("error")} ${t}`);break;case"alert":console.log(`${i.gray("["+a+"]")} ${i.yellow("alert")} ${t}`)}n&&process.exit()}}])}));